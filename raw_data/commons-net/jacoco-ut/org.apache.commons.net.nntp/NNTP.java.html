<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NNTP.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Apache Commons Net</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.net.nntp</a> &gt; <span class="el_source">NNTP.java</span></div><h1>NNTP.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.commons.net.nntp;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;

import org.apache.commons.net.MalformedServerReplyException;
import org.apache.commons.net.ProtocolCommandSupport;
import org.apache.commons.net.SocketClient;
import org.apache.commons.net.io.CRLFLineReader;

/***
 * The NNTP class is not meant to be used by itself and is provided
 * only so that you may easily implement your own NNTP client if
 * you so desire.  If you have no need to perform your own implementation,
 * you should use {@link org.apache.commons.net.nntp.NNTPClient}.
 * The NNTP class is made public to provide access to various NNTP constants
 * and to make it easier for adventurous programmers (or those with special
 * needs) to interact with the NNTP protocol and implement their own clients.
 * A set of methods with names corresponding to the NNTP command names are
 * provided to facilitate this interaction.
 * &lt;p&gt;
 * You should keep in mind that the NNTP server may choose to prematurely
 * close a connection if the client has been idle for longer than a
 * given time period or if the server is being shutdown by the operator or
 * some other reason.  The NNTP class will detect a
 * premature NNTP server connection closing when it receives a
 * {@link org.apache.commons.net.nntp.NNTPReply#SERVICE_DISCONTINUED NNTPReply.SERVICE_DISCONTINUED }
 *  response to a command.
 * When that occurs, the NNTP class method encountering that reply will throw
 * an {@link org.apache.commons.net.nntp.NNTPConnectionClosedException}
 * .
 * &lt;code&gt;NNTPConectionClosedException&lt;/code&gt;
 * is a subclass of &lt;code&gt; IOException &lt;/code&gt; and therefore need not be
 * caught separately, but if you are going to catch it separately, its
 * catch block must appear before the more general &lt;code&gt; IOException &lt;/code&gt;
 * catch block.  When you encounter an
 * {@link org.apache.commons.net.nntp.NNTPConnectionClosedException}
 * , you must disconnect the connection with
 * {@link #disconnect  disconnect() } to properly clean up the
 * system resources used by NNTP.  Before disconnecting, you may check the
 * last reply code and text with
 * {@link #getReplyCode  getReplyCode } and
 * {@link #getReplyString  getReplyString }.
 * &lt;p&gt;
 * Rather than list it separately for each method, we mention here that
 * every method communicating with the server and throwing an IOException
 * can also throw a
 * {@link org.apache.commons.net.MalformedServerReplyException}
 * , which is a subclass
 * of IOException.  A MalformedServerReplyException will be thrown when
 * the reply received from the server deviates enough from the protocol
 * specification that it cannot be interpreted in a useful manner despite
 * attempts to be as lenient as possible.
 *
 * @see NNTPClient
 * @see NNTPConnectionClosedException
 * @see org.apache.commons.net.MalformedServerReplyException
 ***/

public class NNTP extends SocketClient
{
    /*** The default NNTP port.  Its value is 119 according to RFC 977. ***/
    public static final int DEFAULT_PORT = 119;

    // We have to ensure that the protocol communication is in ASCII
    // but we use ISO-8859-1 just in case 8-bit characters cross
    // the wire.
    private static final String __DEFAULT_ENCODING = &quot;ISO-8859-1&quot;;

    boolean _isAllowedToPost;
    int _replyCode;
    String _replyString;

    /**
     * Wraps {@link SocketClient#_input_}
     * to communicate with server.  Initialized by {@link #_connectAction_}.
     * All server reads should be done through this variable.
     */
    protected BufferedReader _reader_;

    /**
     * Wraps {@link SocketClient#_output_}
     * to communicate with server.  Initialized by {@link #_connectAction_}.
     * All server reads should be done through this variable.
     */
    protected BufferedWriter _writer_;

    /**
     * A ProtocolCommandSupport object used to manage the registering of
     * ProtocolCommandListeners and te firing of ProtocolCommandEvents.
     */
    protected ProtocolCommandSupport _commandSupport_;

    /***
     * The default NNTP constructor.  Sets the default port to
     * &lt;code&gt;DEFAULT_PORT&lt;/code&gt; and initializes internal data structures
     * for saving NNTP reply information.
     ***/
    public NNTP()
<span class="nc" id="L120">    {</span>
<span class="nc" id="L121">        setDefaultPort(DEFAULT_PORT);</span>
<span class="nc" id="L122">        _replyString = null;</span>
<span class="nc" id="L123">        _reader_ = null;</span>
<span class="nc" id="L124">        _writer_ = null;</span>
<span class="nc" id="L125">        _isAllowedToPost = false;</span>
<span class="nc" id="L126">        _commandSupport_ = new ProtocolCommandSupport(this);</span>
<span class="nc" id="L127">    }</span>

    private void __getReply() throws IOException
    {
<span class="nc" id="L131">        _replyString = _reader_.readLine();</span>

<span class="nc bnc" id="L133" title="All 2 branches missed.">        if (_replyString == null) {</span>
<span class="nc" id="L134">            throw new NNTPConnectionClosedException(</span>
                    &quot;Connection closed without indication.&quot;);
        }

        // In case we run into an anomaly we don't want fatal index exceptions
        // to be thrown.
<span class="nc bnc" id="L140" title="All 2 branches missed.">        if (_replyString.length() &lt; 3) {</span>
<span class="nc" id="L141">            throw new MalformedServerReplyException(</span>
                &quot;Truncated server reply: &quot; + _replyString);
        }

        try
        {
<span class="nc" id="L147">            _replyCode = Integer.parseInt(_replyString.substring(0, 3));</span>
        }
<span class="nc" id="L149">        catch (NumberFormatException e)</span>
        {
<span class="nc" id="L151">            throw new MalformedServerReplyException(</span>
                &quot;Could not parse response code.\nServer Reply: &quot; + _replyString);
<span class="nc" id="L153">        }</span>

<span class="nc" id="L155">        fireReplyReceived(_replyCode, _replyString + SocketClient.NETASCII_EOL);</span>

<span class="nc bnc" id="L157" title="All 2 branches missed.">        if (_replyCode == NNTPReply.SERVICE_DISCONTINUED) {</span>
<span class="nc" id="L158">            throw new NNTPConnectionClosedException(</span>
                &quot;NNTP response 400 received.  Server closed connection.&quot;);
        }
<span class="nc" id="L161">    }</span>

    /***
     * Initiates control connections and gets initial reply, determining
     * if the client is allowed to post to the server.  Initializes
     * {@link #_reader_} and {@link #_writer_} to wrap
     * {@link SocketClient#_input_} and {@link SocketClient#_output_}.
     ***/
    @Override
    protected void _connectAction_() throws IOException
    {
<span class="nc" id="L172">        super._connectAction_();</span>
<span class="nc" id="L173">        _reader_ =</span>
            new CRLFLineReader(new InputStreamReader(_input_,
                                                     __DEFAULT_ENCODING));
<span class="nc" id="L176">        _writer_ =</span>
            new BufferedWriter(new OutputStreamWriter(_output_,
                                                      __DEFAULT_ENCODING));
<span class="nc" id="L179">        __getReply();</span>

<span class="nc bnc" id="L181" title="All 2 branches missed.">        _isAllowedToPost = (_replyCode == NNTPReply.SERVER_READY_POSTING_ALLOWED);</span>
<span class="nc" id="L182">    }</span>

    /***
     * Closes the connection to the NNTP server and sets to null
     * some internal data so that the memory may be reclaimed by the
     * garbage collector.  The reply text and code information from the
     * last command is voided so that the memory it used may be reclaimed.
     * &lt;p&gt;
     * @throws IOException If an error occurs while disconnecting.
     ***/
    @Override
    public void disconnect() throws IOException
    {
<span class="nc" id="L195">        super.disconnect();</span>
<span class="nc" id="L196">        _reader_ = null;</span>
<span class="nc" id="L197">        _writer_ = null;</span>
<span class="nc" id="L198">        _replyString = null;</span>
<span class="nc" id="L199">        _isAllowedToPost = false;</span>
<span class="nc" id="L200">    }</span>


    /***
     * Indicates whether or not the client is allowed to post articles to
     * the server it is currently connected to.
     * &lt;p&gt;
     * @return True if the client can post articles to the server, false
     *         otherwise.
     ***/
    public boolean isAllowedToPost()
    {
<span class="nc" id="L212">        return _isAllowedToPost;</span>
    }


    /***
     * Sends an NNTP command to the server, waits for a reply and returns the
     * numerical response code.  After invocation, for more detailed
     * information, the actual reply text can be accessed by calling
     * {@link #getReplyString  getReplyString }.
     * &lt;p&gt;
     * @param command  The text representation of the  NNTP command to send.
     * @param args The arguments to the NNTP command.  If this parameter is
     *             set to null, then the command is sent with no argument.
     * @return The integer value of the NNTP reply code returned by the server
     *         in response to the command.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int sendCommand(String command, String args) throws IOException
    {
<span class="nc" id="L237">        StringBuilder __commandBuffer = new StringBuilder();</span>
<span class="nc" id="L238">        __commandBuffer.append(command);</span>

<span class="nc bnc" id="L240" title="All 2 branches missed.">        if (args != null)</span>
        {
<span class="nc" id="L242">            __commandBuffer.append(' ');</span>
<span class="nc" id="L243">            __commandBuffer.append(args);</span>
        }
<span class="nc" id="L245">        __commandBuffer.append(SocketClient.NETASCII_EOL);</span>

        String message;
<span class="nc" id="L248">        _writer_.write(message = __commandBuffer.toString());</span>
<span class="nc" id="L249">        _writer_.flush();</span>

<span class="nc" id="L251">        fireCommandSent(command, message);</span>

<span class="nc" id="L253">        __getReply();</span>
<span class="nc" id="L254">        return _replyCode;</span>
    }


    /***
     * Sends an NNTP command to the server, waits for a reply and returns the
     * numerical response code.  After invocation, for more detailed
     * information, the actual reply text can be accessed by calling
     * {@link #getReplyString  getReplyString }.
     * &lt;p&gt;
     * @param command  The NNTPCommand constant corresponding to the NNTP command
     *                 to send.
     * @param args The arguments to the NNTP command.  If this parameter is
     *             set to null, then the command is sent with no argument.
     * @return The integer value of the NNTP reply code returned by the server
     *         in response to the command.
     *         in response to the command.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int sendCommand(int command, String args) throws IOException
    {
<span class="nc" id="L281">        return sendCommand(NNTPCommand.getCommand(command), args);</span>
    }


    /***
     * Sends an NNTP command with no arguments to the server, waits for a
     * reply and returns the numerical response code.  After invocation, for
     * more detailed information, the actual reply text can be accessed by
     * calling {@link #getReplyString  getReplyString }.
     * &lt;p&gt;
     * @param command  The text representation of the  NNTP command to send.
     * @return The integer value of the NNTP reply code returned by the server
     *         in response to the command.
     *         in response to the command.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int sendCommand(String command) throws IOException
    {
<span class="nc" id="L305">        return sendCommand(command, null);</span>
    }


    /***
     * Sends an NNTP command with no arguments to the server, waits for a
     * reply and returns the numerical response code.  After invocation, for
     * more detailed information, the actual reply text can be accessed by
     * calling {@link #getReplyString  getReplyString }.
     * &lt;p&gt;
     * @param command  The NNTPCommand constant corresponding to the NNTP command
     *                 to send.
     * @return The integer value of the NNTP reply code returned by the server
     *         in response to the command.
     *         in response to the command.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int sendCommand(int command) throws IOException
    {
<span class="nc" id="L330">        return sendCommand(command, null);</span>
    }


    /***
     * Returns the integer value of the reply code of the last NNTP reply.
     * You will usually only use this method after you connect to the
     * NNTP server to check that the connection was successful since
     * &lt;code&gt; connect &lt;/code&gt; is of type void.
     * &lt;p&gt;
     * @return The integer value of the reply code of the last NNTP reply.
     ***/
    public int getReplyCode()
    {
<span class="nc" id="L344">        return _replyCode;</span>
    }

    /***
     * Fetches a reply from the NNTP server and returns the integer reply
     * code.  After calling this method, the actual reply text can be accessed
     * from {@link #getReplyString  getReplyString }.  Only use this
     * method if you are implementing your own NNTP client or if you need to
     * fetch a secondary response from the NNTP server.
     * &lt;p&gt;
     * @return The integer value of the reply code of the fetched NNTP reply.
     *         in response to the command.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while
     *      receiving the server reply.
     ***/
    public int getReply() throws IOException
    {
<span class="nc" id="L366">        __getReply();</span>
<span class="nc" id="L367">        return _replyCode;</span>
    }


    /***
     * Returns the entire text of the last NNTP server response exactly
     * as it was received, not including the end of line marker.
     * &lt;p&gt;
     * @return The entire text from the last NNTP response as a String.
     ***/
    public String getReplyString()
    {
<span class="nc" id="L379">        return _replyString;</span>
    }


    /***
     * A convenience method to send the NNTP ARTICLE command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @param messageId  The message identifier of the requested article,
     *                   including the encapsulating &amp;lt; and &amp;gt; characters.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int article(String messageId) throws IOException
    {
<span class="nc" id="L400">        return sendCommand(NNTPCommand.ARTICLE, messageId);</span>
    }

    /***
     * A convenience method to send the NNTP ARTICLE command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @param articleNumber The number of the article to request from the
     *                      currently selected newsgroup.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int article(long articleNumber) throws IOException
    {
<span class="nc" id="L420">        return sendCommand(NNTPCommand.ARTICLE, Long.toString(articleNumber));</span>
    }

    /***
     * A convenience method to send the NNTP ARTICLE command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int article() throws IOException
    {
<span class="nc" id="L438">        return sendCommand(NNTPCommand.ARTICLE);</span>
    }



    /***
     * A convenience method to send the NNTP BODY command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @param messageId  The message identifier of the requested article,
     *                   including the encapsulating &amp;lt; and &amp;gt; characters.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int body(String messageId) throws IOException
    {
<span class="nc" id="L460">        return sendCommand(NNTPCommand.BODY, messageId);</span>
    }

    /***
     * A convenience method to send the NNTP BODY command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @param articleNumber The number of the article to request from the
     *                      currently selected newsgroup.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int body(long articleNumber) throws IOException
    {
<span class="nc" id="L480">        return sendCommand(NNTPCommand.BODY, Long.toString(articleNumber));</span>
    }

    /***
     * A convenience method to send the NNTP BODY command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int body() throws IOException
    {
<span class="nc" id="L498">        return sendCommand(NNTPCommand.BODY);</span>
    }



    /***
     * A convenience method to send the NNTP HEAD command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @param messageId  The message identifier of the requested article,
     *                   including the encapsulating &amp;lt; and &amp;gt; characters.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int head(String messageId) throws IOException
    {
<span class="nc" id="L520">        return sendCommand(NNTPCommand.HEAD, messageId);</span>
    }

    /***
     * A convenience method to send the NNTP HEAD command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @param articleNumber The number of the article to request from the
     *                      currently selected newsgroup.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int head(long articleNumber) throws IOException
    {
<span class="nc" id="L540">        return sendCommand(NNTPCommand.HEAD, Long.toString(articleNumber));</span>
    }

    /***
     * A convenience method to send the NNTP HEAD command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int head() throws IOException
    {
<span class="nc" id="L558">        return sendCommand(NNTPCommand.HEAD);</span>
    }



    /***
     * A convenience method to send the NNTP STAT command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @param messageId  The message identifier of the requested article,
     *                   including the encapsulating &amp;lt; and &amp;gt; characters.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int stat(String messageId) throws IOException
    {
<span class="nc" id="L580">        return sendCommand(NNTPCommand.STAT, messageId);</span>
    }

    /***
     * A convenience method to send the NNTP STAT command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @param articleNumber The number of the article to request from the
     *                      currently selected newsgroup.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int stat(long articleNumber) throws IOException
    {
<span class="nc" id="L600">        return sendCommand(NNTPCommand.STAT, Long.toString(articleNumber));</span>
    }

    /***
     * A convenience method to send the NNTP STAT command to the server,
     * receive the initial reply, and return the reply code.
     * &lt;p&gt;
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int stat() throws IOException
    {
<span class="nc" id="L618">        return sendCommand(NNTPCommand.STAT);</span>
    }


    /***
     * A convenience method to send the NNTP GROUP command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @param newsgroup  The name of the newsgroup to select.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int group(String newsgroup) throws IOException
    {
<span class="nc" id="L638">        return sendCommand(NNTPCommand.GROUP, newsgroup);</span>
    }


    /***
     * A convenience method to send the NNTP HELP command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int help() throws IOException
    {
<span class="nc" id="L657">        return sendCommand(NNTPCommand.HELP);</span>
    }


    /***
     * A convenience method to send the NNTP IHAVE command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @param messageId  The article identifier,
     *                   including the encapsulating &amp;lt; and &amp;gt; characters.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int ihave(String messageId) throws IOException
    {
<span class="nc" id="L678">        return sendCommand(NNTPCommand.IHAVE, messageId);</span>
    }


    /***
     * A convenience method to send the NNTP LAST command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int last() throws IOException
    {
<span class="nc" id="L697">        return sendCommand(NNTPCommand.LAST);</span>
    }



    /***
     * A convenience method to send the NNTP LIST command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int list() throws IOException
    {
<span class="nc" id="L717">        return sendCommand(NNTPCommand.LIST);</span>
    }



    /***
     * A convenience method to send the NNTP NEXT command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int next() throws IOException
    {
<span class="nc" id="L737">        return sendCommand(NNTPCommand.NEXT);</span>
    }


    /***
     * A convenience method to send the &quot;NEWGROUPS&quot; command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @param date The date after which to check for new groups.
     *             Date format is YYMMDD
     * @param time The time after which to check for new groups.
     *             Time format is HHMMSS using a 24-hour clock.
     * @param GMT  True if the time is in GMT, false if local server time.
     * @param distributions  Comma-separated distribution list to check for
     *            new groups. Set to null if no distributions.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int newgroups(String date, String time, boolean GMT,
                         String distributions) throws IOException
    {
<span class="nc" id="L764">        StringBuilder buffer = new StringBuilder();</span>

<span class="nc" id="L766">        buffer.append(date);</span>
<span class="nc" id="L767">        buffer.append(' ');</span>
<span class="nc" id="L768">        buffer.append(time);</span>

<span class="nc bnc" id="L770" title="All 2 branches missed.">        if (GMT)</span>
        {
<span class="nc" id="L772">            buffer.append(' ');</span>
<span class="nc" id="L773">            buffer.append(&quot;GMT&quot;);</span>
        }

<span class="nc bnc" id="L776" title="All 2 branches missed.">        if (distributions != null)</span>
        {
<span class="nc" id="L778">            buffer.append(&quot; &lt;&quot;);</span>
<span class="nc" id="L779">            buffer.append(distributions);</span>
<span class="nc" id="L780">            buffer.append('&gt;');</span>
        }

<span class="nc" id="L783">        return sendCommand(NNTPCommand.NEWGROUPS, buffer.toString());</span>
    }


    /***
     * A convenience method to send the &quot;NEWNEWS&quot; command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @param newsgroups A comma-separated list of newsgroups to check for new
     *             news.
     * @param date The date after which to check for new news.
     *             Date format is YYMMDD
     * @param time The time after which to check for new news.
     *             Time format is HHMMSS using a 24-hour clock.
     * @param GMT  True if the time is in GMT, false if local server time.
     * @param distributions  Comma-separated distribution list to check for
     *            new news. Set to null if no distributions.
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int newnews(String newsgroups, String date, String time, boolean GMT,
                       String distributions) throws IOException
    {
<span class="nc" id="L812">        StringBuilder buffer = new StringBuilder();</span>

<span class="nc" id="L814">        buffer.append(newsgroups);</span>
<span class="nc" id="L815">        buffer.append(' ');</span>
<span class="nc" id="L816">        buffer.append(date);</span>
<span class="nc" id="L817">        buffer.append(' ');</span>
<span class="nc" id="L818">        buffer.append(time);</span>

<span class="nc bnc" id="L820" title="All 2 branches missed.">        if (GMT)</span>
        {
<span class="nc" id="L822">            buffer.append(' ');</span>
<span class="nc" id="L823">            buffer.append(&quot;GMT&quot;);</span>
        }

<span class="nc bnc" id="L826" title="All 2 branches missed.">        if (distributions != null)</span>
        {
<span class="nc" id="L828">            buffer.append(&quot; &lt;&quot;);</span>
<span class="nc" id="L829">            buffer.append(distributions);</span>
<span class="nc" id="L830">            buffer.append('&gt;');</span>
        }

<span class="nc" id="L833">        return sendCommand(NNTPCommand.NEWNEWS, buffer.toString());</span>
    }



    /***
     * A convenience method to send the NNTP POST command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int post() throws IOException
    {
<span class="nc" id="L853">        return sendCommand(NNTPCommand.POST);</span>
    }



    /***
     * A convenience method to send the NNTP QUIT command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int quit() throws IOException
    {
<span class="nc" id="L873">        return sendCommand(NNTPCommand.QUIT);</span>
    }

    /***
     * A convenience method to send the AUTHINFO USER command to the server,
     *  receive the reply, and return the reply code. (See RFC 2980)
     * &lt;p&gt;
     * @param username A valid username.
     * @return The reply code received from the server. The server should
     *          return a 381 or 281 for this command.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int authinfoUser(String username) throws IOException {
<span class="nc" id="L892">        String userParameter = &quot;USER &quot; + username;</span>
<span class="nc" id="L893">        return sendCommand(NNTPCommand.AUTHINFO, userParameter);</span>
    }

    /***
     * A convenience method to send the AUTHINFO PASS command to the server,
     * receive the reply, and return the reply code.  If this step is
     * required, it should immediately follow the AUTHINFO USER command
     * (See RFC 2980)
     * &lt;p&gt;
     * @param password a valid password.
     * @return The reply code received from the server. The server should
     *         return a 281 or 502 for this command.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int authinfoPass(String password) throws IOException {
<span class="nc" id="L914">        String passParameter = &quot;PASS &quot; + password;</span>
<span class="nc" id="L915">        return sendCommand(NNTPCommand.AUTHINFO, passParameter);</span>
    }

    /***
     * A convenience method to send the NNTP XOVER command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @param selectedArticles a String representation of the range of
     * article headers required. This may be an article number, or a
     * range of article numbers in the form &quot;XXXX-YYYY&quot;, where XXXX
     * and YYYY are valid article numbers in the current group.  It
     * also may be of the form &quot;XXX-&quot;, meaning &quot;return XXX and all
     * following articles&quot; In this revision, the last format is not
     * possible (yet).
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int xover(String selectedArticles) throws IOException {
<span class="nc" id="L939">        return sendCommand(NNTPCommand.XOVER, selectedArticles);</span>
    }

    /***
     * A convenience method to send the NNTP XHDR command to the server,
     * receive the reply, and return the reply code.
     * &lt;p&gt;
     * @param header a String naming a header line (e.g., &quot;subject&quot;).  See
     * RFC-1036 for a list of valid header lines.
     * @param selectedArticles a String representation of the range of
     * article headers required. This may be an article number, or a
     * range of article numbers in the form &quot;XXXX-YYYY&quot;, where XXXX
     * and YYYY are valid article numbers in the current group.  It
     * also may be of the form &quot;XXX-&quot;, meaning &quot;return XXX and all
     * following articles&quot; In this revision, the last format is not
     * possible (yet).
     * @return The reply code received from the server.
     * @throws NNTPConnectionClosedException
     *      If the NNTP server prematurely closes the connection as a result
     *      of the client being idle or some other reason causing the server
     *      to send NNTP reply code 400.  This exception may be caught either
     *      as an IOException or independently as itself.
     * @throws IOException  If an I/O error occurs while either sending the
     *      command or receiving the server reply.
     ***/
    public int xhdr(String header, String selectedArticles) throws IOException {
<span class="nc" id="L965">        StringBuilder command = new StringBuilder(header);</span>
<span class="nc" id="L966">        command.append(&quot; &quot;);</span>
<span class="nc" id="L967">        command.append(selectedArticles);</span>
<span class="nc" id="L968">        return sendCommand(NNTPCommand.XHDR, command.toString());</span>
    }

    /**
     * A convenience wrapper for the extended LIST command that takes
     * an argument, allowing us to selectively list multiple groups.
     * &lt;p&gt;
     * @param wildmat A wildmat (pseudo-regex) pattern. See RFC 2980 for
     *                details.
     * @return the reply code received from the server.
     * @throws IOException if the command fails
     */
    public int listActive(String wildmat) throws IOException {
<span class="nc" id="L981">        StringBuilder command = new StringBuilder(&quot;ACTIVE &quot;);</span>
<span class="nc" id="L982">        command.append(wildmat);</span>
<span class="nc" id="L983">        return sendCommand(NNTPCommand.LIST, command.toString());</span>
    }

    // DEPRECATED METHODS - for API compatibility only - DO NOT USE

    @Deprecated
    public int article(int a) throws IOException
    {
<span class="nc" id="L991">        return article((long) a);</span>
    }

    @Deprecated
    public int body(int a) throws IOException
    {
<span class="nc" id="L997">        return body((long) a);</span>
    }

    @Deprecated
    public int head(int a) throws IOException
    {
<span class="nc" id="L1003">        return head((long) a);</span>
    }

    @Deprecated
    public int stat(int a) throws IOException
    {
<span class="nc" id="L1009">        return stat((long) a);</span>
    }

    /**
     * Provide command support to super-class
     */
    @Override
    protected ProtocolCommandSupport getCommandSupport() {
<span class="nc" id="L1017">        return _commandSupport_;</span>
    }
}

/* Emacs configuration
 * Local variables:        **
 * mode:             java  **
 * c-basic-offset:   4     **
 * indent-tabs-mode: nil   **
 * End:                    **
 */
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>