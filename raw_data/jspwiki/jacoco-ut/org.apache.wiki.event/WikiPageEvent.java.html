<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>WikiPageEvent.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Apache JSPWiki Main Jar</a> &gt; <a href="index.source.html" class="el_package">org.apache.wiki.event</a> &gt; <span class="el_source">WikiPageEvent.java</span></div><h1>WikiPageEvent.java</h1><pre class="source lang-java linenums">/*
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    &quot;License&quot;); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.  
 */

package org.apache.wiki.event;


/**
  * WikiPageEvent indicates a change in the state or processing of a WikiPage.
  * There are basically two types of page events:
  * &lt;dl&gt;
  *   &lt;dt&gt;&lt;b&gt;Phase Boundary Events&lt;/b&gt;&lt;/dt&gt;
  *   &lt;dd&gt;Those considered as &quot;beginning-of-phase&quot;, and those as &quot;end-of-phase&quot;
  *       events (as designated by &lt;tt&gt;*_BEGIN&lt;/tt&gt; and &lt;tt&gt;*_END&lt;/tt&gt;), as
  *       generated by the WikiEngine. The phases include pre-save, post-save,
  *       pre-translate, and post-translate.
  *   &lt;/dd&gt;
  *   &lt;dt&gt;&lt;b&gt;In-Phase Events&lt;/b&gt;&lt;/dt&gt;
  *   &lt;dd&gt;In-phase events are generated as specific events from the
  *       PageEventFilter (or elsewhere), on a per-listener basis. There may
  *       be many such events during a particular phase.
  *   &lt;/dd&gt;
  * &lt;/dl&gt;
  * &lt;p&gt;
  * E.g., a typical event sequence for the pre-translate phase would be:
  * &lt;/p&gt;
  * &lt;ol&gt;
  *  &lt;li&gt;PRE_TRANSLATE_BEGIN&lt;/li&gt;
  *  &lt;li&gt;PRE_TRANSLATE&lt;/li&gt;
  *  &lt;li&gt;PRE_TRANSLATE&lt;/li&gt;
  *  &lt;li&gt;...&lt;/li&gt;
  *  &lt;li&gt;PRE_TRANSLATE_END&lt;/li&gt;
  * &lt;/ol&gt;
  *
  * &lt;h2&gt;Notes&lt;/h2&gt;
  *
  * &lt;h3&gt;Page Requested and Delivered Events&lt;/h3&gt;
  * &lt;p&gt;
  * These two events are fired once per page request, at the beginning
  * and after delivery of the page (respectively). They are generated
  * by the {@link org.apache.wiki.ui.WikiServletFilter}.
  * &lt;/p&gt;
  *
  * &lt;h3&gt;Page Lock and Unlock Events&lt;/h3&gt;
  * &lt;p&gt;
  * Page lock and unlock events occur only once during an editing session,
  * so there are no begin and end events. They are generated
  * by the {@link org.apache.wiki.PageManager}.
  * &lt;/p&gt;
  *
  * &lt;h3&gt;WikiPageEvents&lt;/h3&gt;
  * &lt;p&gt;
  * Other WikiPageEvents include both &lt;i&gt;phase boundary&lt;/i&gt; and &lt;i&gt;in-phase&lt;/i&gt;
  * events for saving, pre- and post-translating content. These are very noisy 
  * event types, but are not fired unless a listener is available. They are
  * generated by the {@link org.apache.wiki.filters.DefaultFilterManager}, 
  * {@link org.apache.wiki.event.PageEventFilter}, and potentially other 
  * implementing classes.
  * &lt;/p&gt;
  *
  * &lt;h3&gt;Firing Order and Phase Boundaries&lt;/h3&gt;
  * &lt;p&gt;
  * Note that due to the asynchronous nature of event processing, any threads
  * spawned by such events will not necessarily have completed during their
  * specific phase; we can assume only that no more events of that phase will
  * be fired after its &lt;tt&gt;*_END&lt;/tt&gt; event has been fired.
  * &lt;/p&gt;
  *
  * @see     org.apache.wiki.event.WikiEvent
  * @since   2.4.20
  */
public class WikiPageEvent extends WikiEvent
{
    // PAGE LOCKING EVENTS ...

    /**
     * 
     */
    private static final long serialVersionUID = 1L;

    /** Indicates a page lock event. This is based on events
      * generated by {@link org.apache.wiki.PageManager}. */
    public static final int PAGE_LOCK            = 10;

    /** Indicates a page unlock event. This is based on events
      * generated by {@link org.apache.wiki.PageManager}. */
    public static final int PAGE_UNLOCK          = 11;

    // PRE_TRANSLATE .........

    /** Indicates the beginning of all wiki pre-translate page events. This is based
      * on events generated by {@link org.apache.wiki.filters.DefaultFilterManager}. */
    public static final int PRE_TRANSLATE_BEGIN  = 12;

    /** Indicates a wiki pre-translate page event. This is based on events
      * generated by {@link org.apache.wiki.event.PageEventFilter}. */
    public static final int PRE_TRANSLATE        = 13;

    /** Indicates the end of all wiki pre-translate page events. This is based
      * on events generated by {@link org.apache.wiki.filters.DefaultFilterManager}. */
    public static final int PRE_TRANSLATE_END    = 14;

    // POST_TRANSLATE ........

    /** Indicates the beginning of all wiki post-translate page events. This is based
      * on events generated by {@link org.apache.wiki.filters.DefaultFilterManager}. */
    public static final int POST_TRANSLATE_BEGIN = 15;

    /** Indicates a wiki post-translate page event. This is based on events
      * generated by {@link org.apache.wiki.event.PageEventFilter}. */
    public static final int POST_TRANSLATE       = 16;

    /** Indicates the end of all wiki post-translate page events. This is based
      * on events generated by {@link org.apache.wiki.filters.DefaultFilterManager}. */
    public static final int POST_TRANSLATE_END   = 17;

    // PRE_SAVE ..............

    /** Indicates the beginning of all wiki pre-save page events. This is based
      * on events generated by {@link org.apache.wiki.filters.DefaultFilterManager}. */
    public static final int PRE_SAVE_BEGIN       = 18;

    /** Indicates a wiki pre-save page event. This is based on events
      * generated by {@link org.apache.wiki.event.PageEventFilter}. */
    public static final int PRE_SAVE             = 19;

    /** Indicates the end of all wiki pre-save page events. This is based
      * on events generated by {@link org.apache.wiki.filters.DefaultFilterManager}. */
    public static final int PRE_SAVE_END         = 20;

    // POST_SAVE .............

    /** Indicates the beginning of all wiki post-save page events. This is based
      * on events generated by {@link org.apache.wiki.filters.DefaultFilterManager}. */
    public static final int POST_SAVE_BEGIN      = 21;

    /** Indicates a wiki post-save page event. This is based on events
      * generated by {@link org.apache.wiki.event.PageEventFilter}. */
    public static final int POST_SAVE            = 22;

    /** Indicates the end of all wiki post-save page events. This is based
      * on events generated by {@link org.apache.wiki.filters.DefaultFilterManager}. */
    public static final int POST_SAVE_END        = 23;

    // PAGE REQUESTS .........

    /** Indicates a wiki page request event (the start of a request). This is based
      * on events generated by {@link org.apache.wiki.ui.WikiServletFilter}. */
    public static final int PAGE_REQUESTED       = 24;

    /** Indicates a wiki page delivery event (the end of a request). This is based
      * on events generated by {@link org.apache.wiki.ui.WikiServletFilter}. */
    public static final int PAGE_DELIVERED       = 25;

    /** Indicates a wiki page delete event (the beginning of a delete request). 
      * This is based on events generated by {@link org.apache.wiki.ui.WikiServletFilter}. 
      * @since 2.4.65 */
    public static final int PAGE_DELETE_REQUEST  = 26;

    /** Indicates a wiki page deleted event (after the delete has been completed). 
      * This is based on events generated by {@link org.apache.wiki.ui.WikiServletFilter}. 
      * @since 2.4.65 */
    public static final int PAGE_DELETED         = 27;

<span class="fc" id="L180">    private String m_pagename     = null;</span>

    // ............


    /**
      * Constructs an instance of this event.
      * @param src    the Object that is the source of the event.
      * @param type      the type of the event (see the enumerated int values defined
      *                  in {@link org.apache.wiki.event.WikiEvent}).
      * @param pagename  the WikiPage being acted upon.
      */
    public WikiPageEvent( Object src, int type, String pagename )
    {
<span class="fc" id="L194">        super( src, type );</span>
<span class="fc" id="L195">        m_pagename = pagename;</span>
<span class="fc" id="L196">    }</span>


   /**
     * Returns the Wiki page name associated with this event.
     * This may be null if unavailable.
     *
     * @return     the Wiki page name associated with this WikiEvent, or null.
     */
    public String getPageName()
    {
<span class="fc" id="L207">        return m_pagename;</span>
    }


   /**
     * Returns true if the int value is a WikiPageEvent type.
     */
    public static boolean isValidType( int type )
    {
<span class="pc bpc" id="L216" title="2 of 4 branches missed.">        return type &gt;= PAGE_LOCK &amp;&amp; type &lt;= PAGE_DELETED;</span>
    }


    /**
     * Returns a textual representation of the event type.
     * @return a String representation of the type
     */
    public String eventName()
    {
<span class="pc bpc" id="L226" title="11 of 19 branches missed.">        switch ( getType() )</span>
        {
<span class="nc" id="L228">            case PAGE_LOCK:            return &quot;PAGE_LOCK&quot;;</span>
<span class="nc" id="L229">            case PAGE_UNLOCK:          return &quot;PAGE_UNLOCK&quot;;</span>

<span class="fc" id="L231">            case PRE_TRANSLATE_BEGIN:  return &quot;PRE_TRANSLATE_BEGIN&quot;;</span>
<span class="nc" id="L232">            case PRE_TRANSLATE:        return &quot;PRE_TRANSLATE&quot;;</span>
<span class="fc" id="L233">            case PRE_TRANSLATE_END:    return &quot;PRE_TRANSLATE_END&quot;;</span>

<span class="fc" id="L235">            case POST_TRANSLATE_BEGIN: return &quot;POST_TRANSLATE_BEGIN&quot;;</span>
<span class="nc" id="L236">            case POST_TRANSLATE:       return &quot;POST_TRANSLATE&quot;;</span>
<span class="fc" id="L237">            case POST_TRANSLATE_END:   return &quot;POST_TRANSLATE_END&quot;;</span>

<span class="fc" id="L239">            case PRE_SAVE_BEGIN:       return &quot;PRE_SAVE_BEGIN&quot;;</span>
<span class="nc" id="L240">            case PRE_SAVE:             return &quot;PRE_SAVE&quot;;</span>
<span class="fc" id="L241">            case PRE_SAVE_END:         return &quot;PRE_SAVE_END&quot;;</span>

<span class="fc" id="L243">            case POST_SAVE_BEGIN:      return &quot;POST_SAVE_BEGIN&quot;;</span>
<span class="nc" id="L244">            case POST_SAVE:            return &quot;POST_SAVE&quot;;</span>
<span class="fc" id="L245">            case POST_SAVE_END:        return &quot;POST_SAVE_END&quot;;</span>

<span class="nc" id="L247">            case PAGE_REQUESTED:       return &quot;PAGE_REQUESTED&quot;;</span>
<span class="nc" id="L248">            case PAGE_DELIVERED:       return &quot;PAGE_DELIVERED&quot;;     </span>

<span class="nc" id="L250">            case PAGE_DELETE_REQUEST:  return &quot;PAGE_DELETE_REQUEST&quot;;     </span>
<span class="nc" id="L251">            case PAGE_DELETED:         return &quot;PAGE_DELETED&quot;;     </span>

<span class="nc" id="L253">            default:                   return super.eventName();</span>
        }
    }


   /** Returns a human-readable description of the event type.
     * @return a String description of the type
     */
    public String getTypeDescription()
    {
<span class="nc bnc" id="L263" title="All 19 branches missed.">        switch ( getType() )</span>
        {
<span class="nc" id="L265">            case PAGE_LOCK:            return &quot;page lock event&quot;;</span>
<span class="nc" id="L266">            case PAGE_UNLOCK:          return &quot;page unlock event&quot;;</span>

<span class="nc" id="L268">            case PRE_TRANSLATE_BEGIN:  return &quot;begin page pre-translate events&quot;;</span>
<span class="nc" id="L269">            case PRE_TRANSLATE:        return &quot;page pre-translate event&quot;;</span>
<span class="nc" id="L270">            case PRE_TRANSLATE_END:    return &quot;end of page pre-translate events&quot;;</span>

<span class="nc" id="L272">            case POST_TRANSLATE_BEGIN: return &quot;begin page post-translate events&quot;;</span>
<span class="nc" id="L273">            case POST_TRANSLATE:       return &quot;page post-translate event&quot;;</span>
<span class="nc" id="L274">            case POST_TRANSLATE_END:   return &quot;end of page post-translate events&quot;;</span>

<span class="nc" id="L276">            case PRE_SAVE_BEGIN:       return &quot;begin page pre-save events&quot;;</span>
<span class="nc" id="L277">            case PRE_SAVE:             return &quot;page pre-save event&quot;;</span>
<span class="nc" id="L278">            case PRE_SAVE_END:         return &quot;end of page pre-save events&quot;;</span>

<span class="nc" id="L280">            case POST_SAVE_BEGIN:      return &quot;begin page post-save events&quot;;</span>
<span class="nc" id="L281">            case POST_SAVE:            return &quot;page post-save event&quot;;</span>
<span class="nc" id="L282">            case POST_SAVE_END:        return &quot;end of page post-save events&quot;;</span>

<span class="nc" id="L284">            case PAGE_REQUESTED:       return &quot;page requested event&quot;;</span>
<span class="nc" id="L285">            case PAGE_DELIVERED:       return &quot;page delivered event&quot;;     </span>

<span class="nc" id="L287">            case PAGE_DELETE_REQUEST:  return &quot;page delete request event&quot;;</span>
<span class="nc" id="L288">            case PAGE_DELETED:         return &quot;page deleted event&quot;;</span>

<span class="nc" id="L290">            default:                   return super.getTypeDescription();</span>
        }
    }

} // end class org.apache.wiki.event.WikiPageEvent
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>